[buildout]
develop = .
parts =
    app
    mkdirs
    mksetting
    mkini
    server
    test

[settings]
host = localhost
port = 8080
repo_root = ${buildout:directory}/var/repo

[app]
recipe = zc.recipe.egg
eggs =
    heso
    PasteScript
    PasteDeploy

[mkdirs]
recipe = z3c.recipe.mkdir
paths =
    ${settings:repo_root}

[mksetting]
recipe = collective.recipe.template
input = inline:
    # This file is generated by buildout. See buildout.cfg.
    REPO_ROOT = '${settings:repo_root}'
output = ${buildout:directory}/src/heso/setting.py

[mkini]
recipe = collective.recipe.template
filename = deploy.ini
input = inline:
    # This file is generated by buildout. See buildout.cfg.
    [server:main]
    use = egg:Paste#http
    host = ${settings:host}
    port = ${settings:port}
    [app:main]
    use = egg:heso
output = ${buildout:directory}/${:filename}

[server]
recipe = zc.recipe.egg:scripts
eggs = ${app:eggs}
entry-points = server=paste.script.command:run
arguments = ['serve', '${mkini:filename}']

[test]
recipe = zc.recipe.testrunner
eggs = heso
defaults = ['--tests-pattern', '^f?tests$', '-v']
